---
- name: Check if address-controller-config exists
  shell: oc get configmap -n {{ namespace }} address-controller-config
  register: config_exists
  ignore_errors: True
- name: Create the address controller config map
  when: config_exists.failed
  shell: oc create configmap address-controller-config --from-literal=enableRbac={{ enable_rbac }} --from-literal=environment={{ enmasse_environment }}
- name: Create the address space definitions
  shell: oc apply -f {{ playbook_dir }}/resources/address-controller/address-space-definitions.yaml
- name: Create the address controller deployment
  shell: oc apply -f {{ playbook_dir }}/resources/address-controller/deployment.yaml
