server {
    server_name viktorkob.tk;

    large_client_header_buffers 4 200k;

    location /Infrastructure {
            proxy_pass http://infrastructure/Infrastructure;
    }
    location /Admin {
            proxy_pass http://admin/Admin;
    }
    location /HbaseIndexingService {
            proxy_pass http://hbase_index/HbaseIndexingService;
    }
    location /RenderService {
            proxy_pass http://render/RenderService;
    }
    location /AnalyticsService {
            proxy_pass http://analytics/AnalyticsService;
    }
    location /LegalService {
            proxy_pass http://legal/LegalService;
    }
    location /UsageDataService {
            proxy_pass http://usage_data/UsageDataService;
    }
    location /NexusService {
            proxy_pass http://nexus/NexusService;
    }

    listen 443 ssl; # managed by Certbot
    ssl_certificate /etc/letsencrypt/live/viktorkob.tk/fullchain.pem; # managed by Certbot
    ssl_certificate_key /etc/letsencrypt/live/viktorkob.tk/privkey.pem; # managed by Certbot
    include /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot
    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot
}

server {
    #We want to use HTTPS so we redirect them instead
    server_name viktorkob.tk;
    listen 80;
    return 301 https://viktorkob.tk$request_uri;
}