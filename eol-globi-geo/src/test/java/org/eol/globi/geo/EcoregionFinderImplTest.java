package org.eol.globi.geo;

import com.vividsolutions.jts.geom.Point;
import org.junit.Test;

import java.util.Collection;
import java.util.Map;

import static junit.framework.Assert.assertNull;
import static org.hamcrest.Matchers.containsString;
import static org.hamcrest.Matchers.notNullValue;
import static org.hamcrest.Matchers.nullValue;
import static org.hamcrest.Matchers.startsWith;
import static org.hamcrest.core.Is.is;
import static org.junit.Assert.assertThat;

public class EcoregionFinderImplTest {

    @Test
    public void longhurstProvince() throws EcoregionFinderException {
        EcoregionFinder finder = new EcoregionFinderFactoryImpl().createEcoregionFinder(EcoregionType.LONGHURST_BIOGEOGRAPHICAL_PROVINCES);
        Point aPointNearFlorida = GeoUtil.getPoint(26.863281, -82.756349);
        Map<String, Object> props = findEcoregionProperties(aPointNearFlorida, finder);
        assertThat(props.toString(), startsWith("{ProvCode=CARB, ProvDescr=Trades - Caribbean Province, the_geom=MULTIPOLYGON"));

        Collection<Ecoregion> ecoregion = finder.findEcoregion(26.863281, -82.756349);
        Ecoregion region = getFirst(ecoregion);
        assertThat(region.getName(), is("Trades - Caribbean Province"));
        assertThat(region.getId(), is("LBP:CARB"));
        assertThat(region.getPath(), is("Trades - Caribbean Province"));
    }

    @Test
    public void fourDifferentEcoregionsGulfOfMexico() throws EcoregionFinderException {
        EcoregionFinder finder = new EcoregionFinderFactoryImpl().createEcoregionFinder(EcoregionType.MARINE_ECOREGIONS_OF_THE_WORLD);
        Collection<Ecoregion> ecoregion270 = finder.findEcoregion(26.863281, -82.756349);
        Ecoregion region = getFirst(ecoregion270);
        assertThat(region.getName(), is("Floridian"));
        assertThat(region.getId(), is("MEOW:20070"));
        assertThat(region.getPath(), is("Floridian | Tropical Northwestern Atlantic | Tropical Atlantic | Tropical"));
        assertThat(region.getGeometry(), is("MULTIPOLYGON (((-81.97706952087646 28.83336952737858, -80.77849861602755 28.466459669724088, -80.76191777620318 28.467735118802977, -79.82453358957105 28.539841565711924, -79.82241088740966 28.51540194637522, -79.74152951534188 27.58417856440542, -79.74152951354324 27.58417824064952, -79.73863762664615 26.997957641791288, -79.77310650144142 26.318409653827587, -79.78697652566473 26.27073533040624, -79.81755665556295 26.165624700316926, -79.8236849407408 25.927508588692717, -79.8267414845082 25.80874578794709, -79.82674148810548 25.808745639558992, -79.82674160231937 25.80874526364238, -79.83626217425854 25.777389044913207, -79.94758757372796 25.410736337601122, -79.98535851979517 25.286336877756185, -79.9853586043314 25.28633659806701, -80.02443353406619 24.994058033918748, -80.02443359881738 24.994057548284843, -80.02443521759704 24.9940554762469, -80.36445235093379 24.558743551967268, -80.36445461542661 24.55874065255307, -80.36617163342055 24.55747949190254, -80.732751592775 24.288224176948063, -80.73275362344418 24.288222684972823, -80.73276416889428 24.288221866589822, -80.75976743607725 24.2861265469856, -80.88022124822237 24.276779926409972, -81.20688447824836 24.25143247565893, -81.23396112111567 24.249331462446946, -81.27364235487687 24.24625239515933, -81.29371753023116 24.244694660586617, -81.2937201616474 24.244694373702885, -81.34834189793185 24.238743081395683, -81.3537713181621 24.238151520854615, -81.3984812144721 24.233280169513762, -81.4007028906201 24.23303810709706, -81.42707347306424 24.23016490901108, -81.55776565012684 24.21947866013926, -81.77560596204114 24.23218355871427, -81.79106181655669 24.233084976163923, -81.83464845695414 24.23562703938211, -81.8346576426294 24.235627575378032, -82.17080742863806 24.254745405345034, -82.18868655852225 24.255762244481843, -82.19689483436025 24.25622907355404, -82.19692263690081 24.25623065456216, -82.19692655794483 24.25623049178489, -82.51501822740181 24.243039940428275, -82.53829859456243 24.242074555102022, -82.5383049536685 24.242075090198625, -82.55688126766745 24.24363711903402, -82.92442668069663 24.27454294919704, -82.92443466667623 24.274543620990585, -82.92548101077023 24.2747241769751, -83.05909292763243 24.297780140806367, -83.08244471355272 24.301809706043343, -83.09255641885494 24.30640568947547, -83.68441471103279 24.57541775310949, -83.83221863638448 24.642597751713424, -83.83222056632957 24.642598628552435, -83.898704529253 24.676706703443415, -84.04847223217439 24.753541133573947, -84.10497653724917 24.782529199978967, -84.27933747989766 24.87198055430565, -85.51109055634709 25.659653555909415, -85.5552940651068 25.73763174289752, -85.59601562739692 25.8129236729705, -85.68466097424738 25.944268277588378, -85.8100225953491 26.20987961702184, -85.85537560223821 26.356290547408832, -85.6686436019425 28.138539567015016, -85.66719195769161 28.152395254246528, -85.65982263149573 28.222734173639083, -85.65982259372419 28.222734530669925, -85.65971972477388 28.222722910530024, -85.65971962315052 28.22272289883881, -83.4404921474108 27.97203001864642, -82.84775150790699 27.905071647164675, -82.80517128889994 27.95046954011559, -82.70911835869447 28.052878608627566, -82.70887542213671 28.053137620566588, -81.97706952087646 28.83336952737858)))"));

        Ecoregion ecoregion243 = getFirst(finder.findEcoregion(29.190533, -92.556153));
        assertThat(ecoregion243.getName(), is("Northern Gulf of Mexico"));
        assertThat(ecoregion243.getId(), is("MEOW:20043"));
        assertThat(ecoregion243.getPath(), is("Northern Gulf of Mexico | Warm Temperate Northwest Atlantic | Temperate Northern Atlantic | Temperate"));

        Ecoregion ecoregion260 = getFirst(finder.findEcoregion(20.179724, -92.380372));
        assertThat(ecoregion260.getName(), is("Southern Gulf of Mexico"));
        assertThat(ecoregion260.getId(), is("MEOW:20069"));
        assertThat(ecoregion260.getPath(), is("Southern Gulf of Mexico | Tropical Northwestern Atlantic | Tropical Atlantic | Tropical"));

        Ecoregion ecoregion265 = getFirst(finder.findEcoregion(23.241346, -83.327638));
        assertThat(ecoregion265.getName(), is("Greater Antilles"));
        assertThat(ecoregion265.getId(), is("MEOW:20065"));
        assertThat(ecoregion265.getPath(), is("Greater Antilles | Tropical Northwestern Atlantic | Tropical Atlantic | Tropical"));
    }

    private Ecoregion getFirst(Collection<Ecoregion> ecoregion270) {
        return ecoregion270.iterator().next();
    }

    @Test
    public void isMarineRegionInNorthernCalifornia() throws EcoregionFinderException {
        EcoregionFinder ecoregionFinder = new EcoregionFinderFactoryImpl().createEcoregionFinder(EcoregionType.MARINE_ECOREGIONS_OF_THE_WORLD);
        Map<String, Object> props = findEcoregionProperties(pointInSanFranciscoBay(), ecoregionFinder);
        assertThat(props.toString(), containsString("ALT_CODE=53.0, ECOREGION=Northern California, ECO_CODE=25058.0, ECO_CODE_X=58.0, Lat_Zone=Temperate, PROVINCE=Cold Temperate Northeast Pacific, PROV_CODE=10.0, REALM=Temperate Northern Pacific, RLM_CODE=3.0"));
    }

    @Test
    public void isMarineRegionInAntarctic() throws EcoregionFinderException {
        EcoregionFinder ecoregionFinder = new EcoregionFinderFactoryImpl().createEcoregionFinder(EcoregionType.MARINE_ECOREGIONS_OF_THE_WORLD);
        Map<String, Object> props = findEcoregionProperties(GeoUtil.getPoint(-57.5, -60), ecoregionFinder);
        assertThat(props, is(nullValue()));
    }

    @Test
    public void isMarineRegionInFloridian() throws EcoregionFinderException {
        EcoregionFinder ecoregionFinder = new EcoregionFinderFactoryImpl().createEcoregionFinder(EcoregionType.MARINE_ECOREGIONS_OF_THE_WORLD);
        Map<String, Object> props = findEcoregionProperties(GeoUtil.getPoint(26.745505, -82.346064), ecoregionFinder);
        String floridian = "{ALT_CODE=69.0, ECOREGION=Floridian, ECO_CODE=20070.0, ECO_CODE_X=70.0, Lat_Zone=Tropical, PROVINCE=Tropical Northwestern Atlantic, PROV_CODE=12.0, REALM=Tropical Atlantic, RLM_CODE=4.0, the_geom=MULTIPOLYGON (((-81.97706952087646 28.83336952737858, -80.77849861602755 28.466459669724088, -80.76191777620318 28.467735118802977, -79.82453358957105 28.539841565711924, -79.82241088740966 28.51540194637522, -79.74152951534188 27.58417856440542, -79.74152951354324 27.58417824064952, -79.73863762664615 26.997957641791288, -79.77310650144142 26.318409653827587, -79.78697652566473 26.27073533040624, -79.81755665556295 26.165624700316926, -79.8236849407408 25.927508588692717, -79.8267414845082 25.80874578794709, -79.82674148810548 25.808745639558992, -79.82674160231937 25.80874526364238, -79.83626217425854 25.777389044913207, -79.94758757372796 25.410736337601122, -79.98535851979517 25.286336877756185, -79.9853586043314 25.28633659806701, -80.02443353406619 24.994058033918748, -80.02443359881738 24.994057548284843, -80.02443521759704 24.9940554762469, -80.36445235093379 24.558743551967268, -80.36445461542661 24.55874065255307, -80.36617163342055 24.55747949190254, -80.732751592775 24.288224176948063, -80.73275362344418 24.288222684972823, -80.73276416889428 24.288221866589822, -80.75976743607725 24.2861265469856, -80.88022124822237 24.276779926409972, -81.20688447824836 24.25143247565893, -81.23396112111567 24.249331462446946, -81.27364235487687 24.24625239515933, -81.29371753023116 24.244694660586617, -81.2937201616474 24.244694373702885, -81.34834189793185 24.238743081395683, -81.3537713181621 24.238151520854615, -81.3984812144721 24.233280169513762, -81.4007028906201 24.23303810709706, -81.42707347306424 24.23016490901108, -81.55776565012684 24.21947866013926, -81.77560596204114 24.23218355871427, -81.79106181655669 24.233084976163923, -81.83464845695414 24.23562703938211, -81.8346576426294 24.235627575378032, -82.17080742863806 24.254745405345034, -82.18868655852225 24.255762244481843, -82.19689483436025 24.25622907355404, -82.19692263690081 24.25623065456216, -82.19692655794483 24.25623049178489, -82.51501822740181 24.243039940428275, -82.53829859456243 24.242074555102022, -82.5383049536685 24.242075090198625, -82.55688126766745 24.24363711903402, -82.92442668069663 24.27454294919704, -82.92443466667623 24.274543620990585, -82.92548101077023 24.2747241769751, -83.05909292763243 24.297780140806367, -83.08244471355272 24.301809706043343, -83.09255641885494 24.30640568947547, -83.68441471103279 24.57541775310949, -83.83221863638448 24.642597751713424, -83.83222056632957 24.642598628552435, -83.898704529253 24.676706703443415, -84.04847223217439 24.753541133573947, -84.10497653724917 24.782529199978967, -84.27933747989766 24.87198055430565, -85.51109055634709 25.659653555909415, -85.5552940651068 25.73763174289752, -85.59601562739692 25.8129236729705, -85.68466097424738 25.944268277588378, -85.8100225953491 26.20987961702184, -85.85537560223821 26.356290547408832, -85.6686436019425 28.138539567015016, -85.66719195769161 28.152395254246528, -85.65982263149573 28.222734173639083, -85.65982259372419 28.222734530669925, -85.65971972477388 28.222722910530024, -85.65971962315052 28.22272289883881, -83.4404921474108 27.97203001864642, -82.84775150790699 27.905071647164675, -82.80517128889994 27.95046954011559, -82.70911835869447 28.052878608627566, -82.70887542213671 28.053137620566588, -81.97706952087646 28.83336952737858)))}";
        assertThat(props.toString(), is(floridian));
        props = findEcoregionProperties(GeoUtil.getPoint(26.798667, -82.149), ecoregionFinder);
        assertThat(props.toString(), is(floridian));
    }

    @Test
    public void isFreshWaterRegionInNorthernCalifornia() throws EcoregionFinderException {
        EcoregionFinder finder = new EcoregionFinderFactoryImpl().createEcoregionFinder(EcoregionType.FRESHWATER_ECOREGIONS_OF_THE_WORLD);
        Ecoregion ecoregion = getFirst(finder.findEcoregion(37.880815, -122.142677));
        assertThat(ecoregion.getName(), is("Sacramento - San Joaquin"));
        assertThat(ecoregion.getId(), is("FEOW:30125"));
        assertThat(ecoregion.getPath(), is("Sacramento - San Joaquin | temperate coastal rivers"));
        assertThat(ecoregion.getGeometry(), is("MULTIPOLYGON (((-121.8013916399999 38.05526739600003, -121.80750281999991 38.05277259600007, -121.81443785999994 38.05360419600004, -121.81889339999992 38.05693815600006, -121.82112125999993 38.061935496000046, -121.82000723999994 38.06805423600008, -121.81139369999994 38.06916051600007, -121.8024901799999 38.06888583600005, -121.79638673999995 38.066665716000045, -121.7930603399999 38.062492416000055, -121.79666141999991 38.058601356000054, -121.8013916399999 38.05526739600003)), ((-120.1629868039999 41.12163991300008, -120.2399999999999 41.03500017600004, -120.28499999999991 41.045000076000065, -120.37999985999994 41.03500017600004, -120.4349999399999 41.080000176000055, -120.46499999999992 41.09000007600008, -120.54999995999992 41.080000176000055, -120.57499997999992 41.05500015600006, -120.58499987999994 41.010000156000046, -120.66499997999995 40.950000216000035, -120.68499995999991 40.945000176000065, -120.7149998399999 40.96500015600009, -120.79499993999991 40.950000216000035, -120.82999985999993 40.90000017600005, -120.83999993999993 40.840000056000065, -120.8567824889999 40.83160878100006, -120.87999989999992 40.82000007600004, -120.90999995999994 40.78500015600008, -120.93999983999993 40.75000005600003, -120.96499985999992 40.740000156000065, -121.09999985999991 40.740000156000065, -121.10999993999991 40.73000007600007, -121.10999993999991 40.69500015600005, -121.08999995999994 40.68000021600005, -121.08499991999992 40.66000005600006, -121.04499995999993 40.63000017600007, -121.04499995999993 40.610000196000044, -121.07999987999995 40.59000021600008, -121.1349999599999 40.595000076000076, -121.1649998399999 40.57000005600008, -121.20999983999991 40.565000196000085, -121.2349998599999 40.52500005600007, -121.2299999999999 40.495000176000076, -121.18499999999995 40.47500019600005, -121.09499999999991 40.48000005600005, -121.0399999199999 40.43000019600004, -121.01999993999993 40.43000019600004, -120.97999997999995 40.405000176000044, -120.93999983999993 40.405000176000044, -120.88499993999994 40.38500019600008, -120.86499995999992 40.360000176000085, -120.85499987999992 40.32000021600004, -120.82499999999993 40.28500011600005, -120.78999989999994 40.28500011600005, -120.75999983999992 40.31500017600007, -120.66999983999995 40.31000013600004, -120.64499999999992 40.295000196000046, -120.58499987999994 40.28500011600005, -120.4199999999999 40.17000009600008, -120.38999993999994 40.13500017600006, -120.24999989999992 40.10000007600007, -120.2049998999999 40.06000011600008, -120.18999995999991 40.01000007600004, -120.1349998799999 39.94500009600006, -120.1049999999999 39.920000076000065, -120.11499989999993 39.87000021600005, -120.1049999999999 39.780000216000076, -120.1449999599999 39.720000096000035, -120.1349998799999 39.65000007600008, -120.1049999999999 39.61000011600004, -120.1099998599999 39.57000015600005, -120.15499985999992 39.545000136000056, -120.2149999799999 39.540000096000085, -120.29499989999994 39.50000013600004, -120.38499989999991 39.50000013600004, -120.4199999999999 39.515000076000035, -120.43999997999993 39.49500009600007, -120.45999995999995 39.44500005600008, -120.44499983999992 39.42500007600006, -120.38499989999991 39.42500007600006, -120.36499991999995 39.410000136000065, -120.3499999799999 39.35000019600005, -120.3249999599999 39.32000013600009, -120.30999983999993 39.275000136000074, -120.27499991999991 39.240000216000055, -120.27499991999991 39.19500021600004, -120.24999989999992 39.165000156000076, -120.2399999999999 39.130000056000085, -120.2399999999999 39.08000019600007, -120.20999993999993 39.06000021600005, -120.19499999999994 39.000000096000065, -120.14999999999992 38.965000176000046, -120.15499985999992 38.89500015600004, -120.1449999599999 38.88000021600004, -120.12999983999993 38.87500017600007, -120.1049999999999 38.84000007600008, -120.04499987999992 38.830000176000055, -120.0399998399999 38.795000076000065, -120.04999991999995 38.78500017600004, -120.04999991999995 38.755000116000076, -120.0399998399999 38.73500013600005, -120.0099999599999 38.71500015600009, -119.97999989999994 38.665000116000044, -119.9399999399999 38.64500013600008, -119.90999987999993 38.60500017600009, -119.86499987999991 38.60000013600006, -119.84499989999995 38.590000056000065, -119.8199998799999 38.54500005600005, -119.77499987999994 38.51500017600006, -119.76499997999991 38.48500011600004, -119.73999995999992 38.460000096000044, -119.67999983999994 38.43000021600005, -119.67499997999994 38.39500011600006, -119.63499983999992 38.355000156000074, -119.63999987999995 38.285000136000065, -119.5999999199999 38.23500009600008, -119.59499987999993 38.18000019600004, -119.55499991999994 38.150000136000074, -119.48499989999993 38.140000056000076, -119.45499983999991 38.10500013600006, -119.3949998999999 38.10500013600006, -119.34999989999994 38.085000156000035, -119.2999994999999 38.02999971600008, -119.31499997999993 37.99500015600006, -119.31499997999993 37.96000005600007, -119.25999989999991 37.91500005600005, -119.2249999799999 37.905000156000085, -119.20999985999993 37.88500017600006, -119.2049998199999 37.805000076000056, -119.2149998999999 37.78500009600009, -119.25499985999994 37.75500021600004, -119.24999981999991 37.73000019600005, -119.1999999599999 37.72500015600008, -119.1899998799999 37.73500005600005, -119.12999993999995 37.73500005600005, -119.10999995999993 37.72500015600008, -119.07499985999993 37.69500009600006, -119.0099998799999 37.575000216000035, -118.91999987999992 37.55000019600004, -118.84999985999991 37.48500021600006, -118.79499995999993 37.48500021600006, -118.7749999799999 37.470000096000035, -118.7649998999999 37.45500015600004, -118.76999993999993 37.42000005600005, -118.7799998399999 37.41500019600005, -118.7749999799999 37.34500017600004, -118.75999985999994 37.325000196000076, -118.69999991999993 37.31500011600008, -118.67499989999993 37.28000019600006, -118.6799999399999 37.21000017600005, -118.66499981999993 37.15500009600004, -118.64499983999991 37.14000015600004, -118.60499987999992 37.14000015600004, -118.51999991999992 37.10500005600005, -118.43499995999991 37.05000015600007, -118.40999993999992 36.97500009600009, -118.3649999399999 36.89500017600005, -118.3799998799999 36.80000013600005, -118.37499983999993 36.77000007600009, -118.33999991999991 36.715000176000046, -118.34999981999994 36.69500019600008, -118.34499995999994 36.67000017600009, -118.30999985999995 36.620000136000044, -118.2949999199999 36.615000096000074, -118.2849998399999 36.56500005600009, -118.24499987999991 36.53000013600007, -118.22499989999994 36.45500007600009, -118.1999998799999 36.43000005600004, -118.1599999199999 36.43000005600004, -118.14999983999991 36.42000015600007, -118.14499997999991 36.370000116000085, -118.10999987999992 36.340000056000065, -118.11999995999992 36.26000013600009, -118.0999999799999 36.210000096000044, -118.0649998799999 36.17500017600008, -118.06999991999993 36.110000196000044, -118.0499999399999 36.07500009600005, -118.03999985999991 36.02500005600007, -118.00999997999992 35.98500009600008, -117.98499995999993 35.890000056000076, -118.00499993999995 35.85000009600009, -117.9949998599999 35.69000007600005, -118.02499991999991 35.67000009600008, -118.03499981999994 35.64500007600009, -118.11499991999995 35.60500011600004, -118.13499989999991 35.55000021600006, -118.13499989999991 35.495000136000044, -118.16999981999993 35.44000005600009, -118.19499983999992 35.43500019600009, -118.24999991999994 35.455000176000055, -118.30999985999995 35.420000076000065, -118.30999985999995 35.39500005600007, -118.28999987999993 35.37000021600005, -118.2799999799999 35.325000216000035, -118.23999983999994 35.245000116000085, -118.2549999599999 35.22500013600006, -118.34499995999994 35.215000056000065, -118.40999993999992 35.21000019600007, -118.42499987999992 35.20000011600007, -118.42999991999994 35.18000013600005, -118.41499997999995 35.16000015600008, -118.41999983999995 35.09500017600004, -118.46999987999993 35.05000017600008, -118.4999999399999 35.00000013600004, -118.58999993999993 34.985000196000044, -118.6099999199999 34.93500015600006, -118.73499983999994 34.88500011600007, -118.79999981999993 34.83000021600009, -118.8099026999999 34.800496776000045, -118.85384465999994 34.80354723600004, -118.88000099999994 34.80000087600007, -118.91500001999992 34.78499949600007, -118.94999921999994 34.79000079600007, -118.9999994399999 34.77499941600007, -119.11000031999993 34.81000095600007, -119.17499975999993 34.81499973600006, -119.20499999999993 34.834999896000056, -119.22500015999992 34.86500013600005, -119.34500093999992 34.875000216000046, -119.41000037999993 34.94999955600008, -119.43000053999992 34.95500085600008, -119.47000085999991 34.99500117600007, -119.51999891999992 35.024999076000086, -119.63999969999992 35.064999396000076, -119.7400004999999 35.08499955600007, -119.83499999999992 35.12000091600004, -119.9150006399999 35.16500001600008, -120.05000045999992 35.19999921600004, -120.2399996399999 35.209999296000035, -120.5199995399999 35.31500121600004, -120.7450000799999 35.47999893600007, -120.86999981999992 35.549999496000055, -121.00000085999994 35.69000061600008, -121.05999899999995 35.73499971600006, -121.26000041999993 35.845000596000034, -121.3432466399999 35.901291996000054, -121.40480015999992 35.97403539600003, -121.43837429999991 36.031856436000055, -121.49992547999994 36.104599836000034, -121.56000047999993 36.17999967600008, -121.60499957999991 36.225001116000044, -121.6845811799999 36.292985316000056, -121.78500101999992 36.38500005600008, -121.8423657599999 36.44151267600006, -121.8944703599999 36.45851763600007, -121.89639275999991 36.464996376000045, -121.89890285999991 36.46971129600007, -121.9086226799999 36.48220833600004, -121.91333003999989 36.49193571600006, -121.91694641999993 36.50833137600006, -121.9216613399999 36.518051196000044, -121.92304985999994 36.52360527600007, -121.92223355999994 36.529716456000074, -121.91777045999993 36.53276817600005, -121.90055849999993 36.53249367600006, -121.8952789199999 36.53499603600005, -121.89334103999994 36.54055029600005, -121.8997268999999 36.54888159600006, -121.9044493799999 36.55832673600008, -121.91333003999989 36.57166293600005, -121.9355468999999 36.57471465600008, -121.94167319999991 36.57694251600009, -121.94666297999993 36.57999423600006, -121.94526671999989 36.59276577600008, -121.94332883999994 36.59804535600006, -121.93776701999991 36.60749823600008, -121.92694091999994 36.619438176000074, -121.91806025999995 36.62609871600006, -121.91443631999994 36.62998959600009, -121.90888979999994 36.639434736000055, -121.9044493799999 36.64276887600005, -121.8958435799999 36.64249419600009, -121.88999933999992 36.64027407600008, -121.87666313999989 36.62971491600007, -121.87000277999994 36.622215216000086, -121.8608170199999 36.614440836000085, -121.85500337999991 36.61305231600005, -121.84805303999991 36.61415859600004, -121.84194941999993 36.61610421600005, -121.8313904399999 36.62110137600007, -121.81973273999989 36.63304905600006, -121.81331627999992 36.64166259600006, -121.80499271999992 36.65526573600005, -121.80027761999992 36.66526797600005, -121.79833991999993 36.67054755600009, -121.79723363999994 36.67665855600006, -121.79695121999993 36.68360133600004, -121.7947235399999 36.69582369600005, -121.79415887999994 36.709159896000074, -121.79138183999993 36.71471397600004, -121.78806299999991 36.733047516000056, -121.78307339999992 36.74249265600008, -121.77471923999991 36.74221797600006, -121.75279235999994 36.73137657600006, -121.74665831999994 36.72971337600006, -121.74500267999991 36.73054497600009, -121.73972327999991 36.733604436000064, -121.73860169999995 36.73915869600006, -121.73999021999992 36.744712776000085, -121.74249275999995 36.749999916000036, -121.74553673999992 36.754165656000055, -121.75334171999992 36.75444033600007, -121.75945289999993 36.75249489600009, -121.7672270999999 36.75138861600004, -121.77250667999994 36.75444033600007, -121.77471923999991 36.75916281600007, -121.77166751999994 36.769989096000074, -121.76944739999993 36.782211276000055, -121.76750177999992 36.78749841600006, -121.76695259999991 36.80110173600008, -121.76583857999992 36.80721291600008, -121.76390069999991 36.81249231600009, -121.7602767599999 36.81666561600008, -121.75834661999994 36.82193763600009, -121.76139833999991 36.82555383600004, -121.77084347999994 36.83249661600007, -121.78388969999992 36.84860229600008, -121.79083247999989 36.86305233600007, -121.79638673999995 36.87943269600004, -121.80194099999994 36.888603156000045, -121.8177795599999 36.90248871600005, -121.82112125999993 36.90749361600007, -121.82444765999992 36.91082001600006, -121.8477783599999 36.94693755600008, -121.8544464599999 36.95443725600006, -121.87110905999992 36.968597496000086, -121.8765070799999 36.97120443600005, -121.8700004399999 36.97499991600006, -121.82000003999991 36.99000111600009, -121.78999979999992 37.025000316000046, -121.78999979999992 37.05500055600004, -121.80999995999991 37.079999496000084, -121.95000107999994 37.10999973600008, -122.00999921999994 37.13999997600007, -122.1349989599999 37.27000101600004, -122.21000063999992 37.389999636000084, -122.27500007999993 37.53000057600008, -122.27824961999994 37.57550475600004, -122.27333075999991 37.57499697600008, -122.26555637999991 37.57527165600004, -122.24610899999993 37.58027655600006, -122.2375030199999 37.58027655600006, -122.23332215999994 37.576660176000075, -122.23082735999992 37.57193751600005, -122.23056023999993 37.55888373600004, -122.22805787999994 37.55416107600007, -122.2219391399999 37.551933216000066, -122.2080535799999 37.548881496000035, -122.18250275999992 37.540275516000065, -122.18360903999991 37.53472143600004, -122.18721011999992 37.53082281600007, -122.18916311999993 37.52526855600007, -122.18749991999994 37.519988976000036, -122.18055731999993 37.51832577600004, -122.1736067999999 37.51943961600006, -122.16388697999992 37.52555079600006, -122.15583809999993 37.52582547600008, -122.15083319999991 37.52304843600007, -122.14835351999994 37.51832577600004, -122.1477812999999 37.51277169600007, -122.14362329999994 37.50943755600008, -122.13667295999994 37.507774356000084, -122.1277771799999 37.507499676000066, -122.12082665999992 37.50888819600004, -122.11221311999992 37.50860595600005, -122.10804755999993 37.50499731600007, -122.10556031999994 37.500274656000045, -122.10249329999994 37.48943325600004, -122.09916689999994 37.48526769600005, -122.0911102799999 37.47137457600007, -122.0869369799999 37.46776575600006, -122.07668309999991 37.46221167600004, -122.07055661999993 37.45999137600006, -122.05499273999993 37.45749657600004, -122.02971641999994 37.45638273600008, -122.01666263999994 37.459434456000054, -122.0058365399999 37.47137457600007, -122.00917049999993 37.475547876000064, -122.0169524399999 37.476379476000034, -122.02971641999994 37.479431196000064, -122.03307341999994 37.483604496000055, -122.0316771599999 37.496383596000044, -122.03333279999993 37.50193785600004, -122.04167183999994 37.508331276000035, -122.0535964799999 37.51332861600008, -122.0605468199999 37.51471713600006, -122.07224267999993 37.50971979600007, -122.07917789999993 37.50860595600005, -122.08249655999992 37.511939916000074, -122.0872192199999 37.52165991600009, -122.0902862399999 37.532493576000036, -122.09277347999989 37.53749847600005, -122.09612273999994 37.54222113600008, -122.1058272599999 37.56221013600009, -122.11054991999993 37.57110591600008, -122.11389161999995 37.57527165600004, -122.12361143999993 37.59443661600005, -122.1283263599999 37.61110695600007, -122.13027953999995 37.62332157600008, -122.1313782599999 37.641105576000086, -122.1361235999999 37.65749367600006, -122.1408386999999 37.66693881600008, -122.1524963999999 37.68498993600008, -122.1572266199999 37.694709756000066, -122.17471307999995 37.71471405600005, -122.18276969999994 37.71638481600007, -122.19415289999989 37.711937016000036, -122.20111079999992 37.710548316000086, -122.2088927399999 37.712211696000054, -122.21333315999993 37.71499629600004, -122.21584325999993 37.719711216000064, -122.21305847999992 37.724433876000035, -122.20834355999995 37.727768016000084, -122.21083061999991 37.73249049600008, -122.21861273999991 37.73360451600007, -122.22389213999992 37.73638155600008, -122.22721853999991 37.74054711600007, -122.2244414999999 37.74582669600005, -122.21721647999993 37.74694053600007, -122.2008438599999 37.74610137600007, -122.19360353999991 37.747215216000086, -122.1908264999999 37.751937876000056, -122.1933288599999 37.75666053600008, -122.2063903799999 37.760551416000055, -122.2219391399999 37.76221461600005, -122.24276729999991 37.76666259600006, -122.25473027999993 37.77110283600007, -122.26278689999992 37.772491536000075, -122.28083801999992 37.77832785600009, -122.28694145999992 37.780548156000066, -122.29723349999995 37.78638465600005, -122.30194085999995 37.79582979600008, -122.30166617999993 37.80277257600005, -122.29972847999994 37.80804441600009, -122.30110169999995 37.82027433600007, -122.29998785999993 37.82638551600007, -122.29472357999992 37.829162556000085, -122.28833015999993 37.83082575600008, -122.28388973999989 37.834159896000074, -122.2827834599999 37.84027107600008, -122.2858276199999 37.85749815600008, -122.28971867999991 37.86776733600004, -122.29110719999994 37.87998969600005, -122.29472357999992 37.89694209600009, -122.29723349999995 37.90193169600008, -122.30055233999991 37.90609743600004, -122.30471807999993 37.910270736000086, -122.30999747999994 37.91304777600004, -122.31696311999991 37.914436296000076, -122.32472237999991 37.914154056000086, -122.33889773999994 37.911659256000064, -122.34665681999991 37.91249085600003, -122.35193639999994 37.915267896000046, -122.35610969999993 37.91944119600004, -122.36528015999994 37.931938236000065, -122.3780516999999 37.94248965600008, -122.38333127999994 37.94582361600004, -122.39083853999995 37.95277413600007, -122.39334107999991 37.95777129600009, -122.39472959999989 37.96305087600007, -122.37832637999992 37.96221153600004, -122.37361145999989 37.96554567600003, -122.37361145999989 37.972213776000046, -122.37082667999994 37.97748561600008, -122.36609645999994 37.98165891600007, -122.3608168799999 37.98360435600006, -122.35278311999991 37.99082955600005, -122.34999077999993 37.99554447600008, -122.34805289999991 38.000831616000085, -122.3491669199999 38.01332847600008, -122.34555053999992 38.017211976000056, -122.3375092199999 38.01915741600004, -122.32721717999993 38.01471717600003, -122.31945791999993 38.01332847600008, -122.31166067999993 38.01305397600004, -122.29666145999994 38.01471717600003, -122.2913818799999 38.016662616000076, -122.2858276199999 38.01915741600004, -122.2713928799999 38.029159476000075, -122.24777219999993 38.05110165600007, -122.24054717999991 38.05915827600006, -122.22888191999994 38.06415561600005, -122.21584325999993 38.066665716000045, -122.20777889999994 38.065826376000075, -122.18694299999993 38.061378396000066, -122.17083731999992 38.05277259600007, -122.16221621999989 38.046386736000045, -122.15194703999992 38.04083247600005, -122.13971711999994 38.03582757600009, -122.13276677999994 38.03472129600004, -122.11609643999992 38.03527065600008, -122.10888671999993 38.03694159600008, -122.06360627999993 38.05554963600008, -122.03778077999993 38.06332401600008, -122.01583859999994 38.066101056000036, -121.9894408799999 38.065544136000085, -121.98332213999993 38.062492416000055, -121.96250909999992 38.058601356000054, -121.9155578999999 38.054161116000046, -121.89695741999992 38.05360419600004, -121.88221739999994 38.05193325600004, -121.86916343999991 38.04804993600004, -121.85722349999992 38.04305259600005, -121.83721919999994 38.03721627600004, -121.83029171999993 38.03610999600005, -121.81360625999991 38.03499597600006, -121.75945289999993 38.028877236000085, -121.7508391799999 38.02860255600007, -121.73500061999994 38.029716576000055, -121.72193909999993 38.025825516000054, -121.71083075999991 38.02027125600006, -121.6977692399999 38.017211976000056, -121.6899871199999 38.01693729600004, -121.6758270599999 38.01915741600004, -121.66333001999993 38.02304847600004, -121.66471853999991 38.02832787600005, -121.66999811999995 38.03137977600005, -121.67778023999995 38.03221137600008, -121.68582155999991 38.03166201600004, -121.69275659999994 38.033332776000066, -121.69611359999993 38.038047876000064, -121.69304657999993 38.04360969600009, -121.6861115399999 38.04471579600005, -121.67443853999993 38.04833217600009, -121.66999811999995 38.05165857600008, -121.66443629999992 38.054161116000046, -121.66082765999994 38.058326676000036, -121.65805061999993 38.06304933600006, -121.65611273999991 38.06832891600004, -121.65471647999993 38.074439916000074, -121.65444953999992 38.08110801600009, -121.65249635999993 38.086654716000055, -121.6480636799999 38.090545596000084, -121.64250185999992 38.09249121600004, -121.6355590799999 38.09360505600006, -121.62082679999992 38.091102516000035, -121.6080475199999 38.10166167600005, -121.6024932599999 38.10416403600004, -121.59555047999993 38.10555273600005, -121.58666999999991 38.10527031600009, -121.57972721999994 38.103607116000035, -121.5714034799999 38.09665677600009, -121.56806951999994 38.09249121600004, -121.56500249999993 38.08138269600005, -121.56166079999991 38.07721713600006, -121.55666345999992 38.074439916000074, -121.53751379999994 38.06777199600003, -121.52722175999992 38.061935496000046, -121.5213928199999 38.05971519600007, -121.51471715999992 38.05138389600006, -121.5105591599999 38.04804993600004, -121.50361637999993 38.046386736000045, -121.4980468199999 38.04888153600007, -121.4910964799999 38.04999537600008, -121.48416143999992 38.04777525600008, -121.4816666399999 38.04360969600009, -121.48110953999992 38.037498516000085, -121.47778313999993 38.033332776000066, -121.47277823999991 38.03054817600008, -121.46584319999994 38.028877236000085, -121.45556645999994 38.02388007600007, -121.44275657999992 38.01332847600008, -121.43943791999993 38.00916291600004, -121.42916873999991 38.00332641600005, -121.42138679999994 38.00249481600008, -121.4186095799999 38.00721747600005, -121.41999809999993 38.012771556000075, -121.42331693999989 38.01693729600004, -121.4308319399999 38.02388007600007, -121.4349974999999 38.02748871600005, -121.44943241999994 38.03721627600004, -121.4527892399999 38.04083247600005, -121.47055055999994 38.05499271600007, -121.48610687999991 38.06360625600007, -121.49722295999993 38.06805423600008, -121.5075072599999 38.07360831600005, -121.51363373999993 38.07582861600008, -121.5283431599999 38.078330976000075, -121.5333327599999 38.08138269600005, -121.53666689999994 38.08471683600004, -121.54387661999993 38.09999847600005, -121.55055227999992 38.10888669600007, -121.5558318599999 38.111938416000044, -121.57668305999994 38.115829476000044, -121.59333809999993 38.115547236000054, -121.60028069999993 38.11388403600006, -121.6058273999999 38.111938416000044, -121.62110903999991 38.103324876000045, -121.6463927399999 38.10471339600008, -121.65361019999995 38.103607116000035, -121.65888977999992 38.10110475600004, -121.66722107999993 38.093879736000076, -121.66915895999995 38.08776855600007, -121.66860959999991 38.082214296000075, -121.66610723999992 38.07749181600008, -121.66722107999993 38.07138063600007, -121.67083745999992 38.06749731600007, -121.67555237999994 38.06415561600005, -121.7024994599999 38.05193325600004, -121.71389777999991 38.04749301600009, -121.72112279999993 38.045547396000075, -121.7280578399999 38.04444129600006, -121.73610689999992 38.04471579600005, -121.74305723999993 38.046104496000055, -121.74889373999991 38.04833217600009, -121.75834661999994 38.05554963600008, -121.7608336799999 38.05971519600007, -121.76222237999991 38.06499477600005, -121.7602767599999 38.070549036000045, -121.75583651999995 38.074439916000074, -121.73944085999995 38.082214296000075, -121.72721867999991 38.08526619600008, -121.70612339999991 38.08860015600004, -121.69972223999991 38.090545596000084, -121.69444265999994 38.093879736000076, -121.69138337999993 38.09777061600005, -121.68943793999989 38.103324876000045, -121.67527769999992 38.126655576000076, -121.67111213999993 38.143608156000084, -121.6688767199999 38.14971915600006, -121.66860959999991 38.156379696000045, -121.67304983999992 38.15304573600008, -121.67694089999992 38.148605316000044, -121.68888857999991 38.13804633600006, -121.70639033999993 38.11721043600005, -121.72193909999993 38.10221859600006, -121.73554997999992 38.09221653600008, -121.7572325999999 38.08193961600006, -121.77749627999992 38.07694245600004, -121.78472903999995 38.07666021600005, -121.80803687999992 38.079162576000044, -121.83860771999991 38.08415991600009, -121.84665677999993 38.08360281600005, -121.85028071999994 38.07971949600005, -121.84889219999991 38.074165416000085, -121.85333243999992 38.070831276000035, -121.8586120199999 38.06832891600004, -121.87193291999989 38.06526945600007, -121.90194701999991 38.061935496000046, -121.9052734199999 38.066101056000036, -121.90167233999995 38.06999211600004, -121.8961180799999 38.07249447600009, -121.8872222999999 38.07999417600007, -121.88612357999995 38.08526619600008, -121.8911133599999 38.08804323600009, -121.8991699799999 38.08776855600007, -121.91416937999992 38.08526619600008, -121.93083197999994 38.085823116000086, -121.94638055999991 38.08749387600005, -121.96640015999992 38.09276589600006, -121.9777831799999 38.09721369600004, -121.98194891999992 38.10054783600009, -121.98249809999993 38.10665901600004, -121.97888189999992 38.111381496000035, -121.97055059999991 38.11804959600005, -121.9669495199999 38.12193291600005, -121.96056365999993 38.130546636000076, -121.95944207999992 38.13665763600005, -121.9608305999999 38.14221945600008, -121.96417229999992 38.14638519600004, -121.9694518799999 38.14916223600005, -121.98222359999994 38.15360265600009, -121.99833683999992 38.15277105600006, -122.01167303999989 38.14971915600006, -122.02390295999993 38.14582827600009, -122.0363922599999 38.14138029600008, -122.04110717999993 38.13804633600006, -122.04472355999991 38.13416283600009, -122.0472336599999 38.114997876000075, -122.04915623999995 38.11027521600005, -122.0527801799999 38.10582741600007, -122.0700072599999 38.09249121600004, -122.07528683999993 38.089988676000075, -122.08889771999992 38.07999417600007, -122.10083009999994 38.06888583600005, -122.10610967999992 38.065544136000085, -122.10973361999993 38.061378396000066, -122.11972037999993 38.05554963600008, -122.1274871999999 38.05526739600003, -122.13555911999993 38.05609899600006, -122.14584341999989 38.062492416000055, -122.14998629999991 38.066665716000045, -122.15862269999991 38.07276915600005, -122.1644363399999 38.074439916000074, -122.18749991999994 38.07138063600007, -122.19360353999991 38.07305139600004, -122.20388801999991 38.078605656000036, -122.21611019999995 38.083053636000045, -122.22305297999992 38.08193961600006, -122.2266693599999 38.07777405600007, -122.23473353999992 38.078605656000036, -122.23693853999993 38.08360281600005, -122.25556943999993 38.10305019600008, -122.26418297999993 38.10999297600006, -122.2797164399999 38.11832427600007, -122.28472907999992 38.122764516000075, -122.2994384999999 38.131103556000085, -122.31139373999991 38.136108456000045, -122.34277349999991 38.14554603600004, -122.34777839999992 38.148605316000044, -122.36528015999994 38.155548096000075, -122.37026975999993 38.15859981600005, -122.38305659999992 38.168884296000044, -122.38694765999992 38.16499323600004, -122.3889008399999 38.159713656000065, -122.39083853999995 38.147491476000084, -122.39584343999991 38.13721473600009, -122.39943695999995 38.13249207600006, -122.40915677999993 38.126655576000076, -122.42166137999993 38.122764516000075, -122.4366607799999 38.12443545600007, -122.44444271999993 38.12416077600005, -122.45944211999989 38.12165823600009, -122.47528067999991 38.12054439600007, -122.48137655999994 38.118598956000085, -122.48166653999994 38.111938416000044, -122.47057349999994 38.09347527600005, -122.4702835199999 38.08776855600007, -122.47055045999991 38.08110801600009, -122.47471619999993 38.057212836000076, -122.47693631999994 38.05193325600004, -122.47778321999994 38.04582981600004, -122.48361197999992 38.029716576000055, -122.48306279999991 38.02360539600005, -122.46112061999992 38.01971433600005, -122.43721013999993 38.00360865600004, -122.43472289999994 37.99860375600008, -122.4358216199999 37.99193565600007, -122.44027715999994 37.989158616000054, -122.44666283999993 37.98804477600004, -122.45973209999994 37.98416145600004, -122.46972659999994 37.97832495600005, -122.4733276799999 37.97443389600005, -122.47370729999994 37.972351476000085, -122.66500067999993 38.04999987600007, -122.70500099999992 38.11000035600006, -122.73499889999994 38.24500035600005, -122.7900004199999 38.32999977600008, -122.89999895999989 38.42000049600006, -123.0050008799999 38.484999756000036, -123.03499877999991 38.595000636000066, -123.16000085999991 38.74000053600008, -123.21500021999992 38.85500019600005, -123.26500061999991 38.92500075600009, -123.2899995599999 39.05000049600005, -123.32999987999995 39.159999036000045, -123.38000027999993 39.25999983600008, -123.3749991599999 39.295001196000044, -123.34499891999991 39.32000031600006, -123.22500029999992 39.33499917600005, -123.0700003199999 39.33499917600005, -122.9950007999999 39.310000236000064, -122.93500031999992 39.30499911600003, -122.86000097999994 39.24999975600008, -122.72999993999991 39.24999975600008, -122.72999993999991 39.269999916000074, -122.76499913999993 39.30000015600007, -122.76499913999993 39.33499917600005, -122.75000009999991 39.36000063600005, -122.8000004999999 39.39499965600004, -122.8000004999999 39.42000111600004, -122.74499897999993 39.44000127600009, -122.72999993999991 39.49500045600007, -122.68999961999992 39.51999957600009, -122.67999953999993 39.54500085600006, -122.71999985999992 39.60499899600006, -122.80499945999992 39.65499939600005, -122.80499945999992 39.70499979600004, -122.81499953999992 39.72000099600007, -122.8850000999999 39.745000116000085, -122.94500039999991 39.809999376000064, -122.95500047999991 39.86500089600008, -122.94500039999991 39.90000009600004, -122.91999911999994 39.930000336000035, -122.91999911999994 39.95000049600009, -122.94999935999994 40.00499967600007, -122.94999935999994 40.05000129600006, -122.97999959999993 40.14500079600003, -122.9750006399999 40.16999973600008, -122.97999959999993 40.24000029600006, -123.06000023999991 40.28000061600005, -123.0649990199999 40.33000101600004, -122.97999959999993 40.41999939600004, -122.8950001799999 40.45500075600006, -122.84499977999991 40.500000036000074, -122.8000004999999 40.515001236000046, -122.77499921999993 40.54499913600006, -122.70500099999992 40.580000676000054, -122.69999969999992 40.60000065600008, -122.74000001999991 40.665000096000085, -122.74000001999991 40.68500025600008, -122.71500107999992 40.70999919600007, -122.70500099999992 40.74999951600006, -122.66500067999993 40.77999975600005, -122.64500051999994 40.850000316000035, -122.60500019999989 40.894999416000076, -122.59999907999992 40.96499997600006, -122.53499963999991 41.00999925600007, -122.52000077999992 41.079999816000054, -122.47499915999992 41.08999989600005, -122.45000021999994 41.11000005600005, -122.45000021999994 41.15499915600009, -122.49000053999993 41.18000043600006, -122.51499947999991 41.21499963600007, -122.50000061999992 41.30500035600005, -122.39500085999993 41.379999696000084, -122.31500039999992 41.37500073600006, -122.22000071999992 41.40500097600005, -122.19000047999992 41.42500113600005, -122.18000039999993 41.45499903600006, -122.1449990399999 41.500000656000054, -122.07999977999992 41.49499935600005, -122.0650007399999 41.47000041600006, -122.04500057999991 41.460000336000064, -122.02500041999991 41.47000041600006, -121.92499961999994 41.474999196000056, -121.84499915999993 41.53000089600005, -121.6499986799999 41.580001296000034, -121.59499949999991 41.61500031600008, -121.53499901999993 41.60999919600005, -121.48999991999995 41.580001296000034, -121.4599996799999 41.580001296000034, -121.4399995199999 41.59000137600009, -121.3349997599999 41.59500015600008, -121.30499969999994 41.61500031600008, -121.28499953999994 41.61500031600008, -121.23000017999993 41.540000976000044, -121.1750009999999 41.51000073600005, -121.1199992999999 41.51000073600005, -121.09500035999991 41.52499959600004, -121.06500011999992 41.52499959600004, -121.04499995999993 41.54499975600004, -121.0399988399999 41.57000121600004, -121.02000101999994 41.585000076000085, -120.98000069999989 41.59999911600005, -120.9149989199999 41.59999911600005, -120.90000005999991 41.585000076000085, -120.91000013999991 41.540000976000044, -120.87999989999992 41.53000089600005, -120.82999949999993 41.57499999600009, -120.82999949999993 41.619999276000044, -120.81500045999991 41.66999949600006, -120.73000103999993 41.74000005600004, -120.62499911999993 41.77499925600006, -120.59294993999993 41.82747231600007, -120.56999975999992 41.935000356000046, -120.61499903999993 41.975000676000036, -120.69000071999994 41.985000756000034, -120.70499975999991 42.03500115600008, -120.75999893999995 42.06499905600003, -120.79999925999994 42.06499905600003, -120.8350006199999 42.05000019600004, -120.85999973999992 42.06000027600004, -120.88999997999991 42.054998976000036, -120.91000013999991 42.07000035600004, -120.91000013999991 42.09000051600009, -120.89499875999991 42.10499937600008, -120.86999981999992 42.09499929600008, -120.83999957999993 42.100000596000086, -120.81999941999993 42.17000097600004, -120.81999941999993 42.21999903600005, -120.80500037999991 42.23999919600004, -120.80500037999991 42.25999935600004, -120.82999949999993 42.285000816000036, -120.82999949999993 42.315001056000085, -120.78999917999994 42.34500129600008, -120.70499975999991 42.339999996000074, -120.69145598099993 42.35354377500005, -120.6659585459999 42.345044630000075, -120.63459315699993 42.364346408000074, -120.61529137899993 42.367965491000064, -120.59237051799994 42.37037821300004, -120.57910054599989 42.367965491000064, -120.5754814629999 42.364346408000074, -120.54290971299991 42.364346408000074, -120.53325882399992 42.38485454600004, -120.50913160199991 42.39209271300007, -120.4994807139999 42.39209271300007, -120.50189343599993 42.40294996300008, -120.49224254699993 42.41501357400006, -120.48621074099992 42.41501357400006, -120.47655985299991 42.41018812900006, -120.4657026029999 42.41260085200008, -120.45363899199992 42.42587082400007, -120.4415753809999 42.43069626800008, -120.42830540799991 42.42587082400007, -120.41503543599993 42.41139449100007, -120.40176546399994 42.40536268500006, -120.3933209359999 42.39450543500004, -120.36678099199992 42.38847363000008, -120.34386013099993 42.37158457400005, -120.32938379799992 42.348663713000064, -120.3173201869999 42.335393741000075, -120.31128838099994 42.30885379700004, -120.3076692979999 42.28955201900004, -120.2980184089999 42.28352021400008, -120.27268482599993 42.28231385300006, -120.26182757599992 42.27990113000004, -120.26182757599992 42.27628204700005, -120.26665302099991 42.26301207500006, -120.27389118699995 42.25456754700008, -120.2883675199999 42.25818663000007, -120.29681204799994 42.25698026900005, -120.2943993259999 42.24732938100004, -120.2883675199999 42.23888485300006, -120.29078024299992 42.23164668600003, -120.2980184089999 42.22923396400006, -120.29922476999991 42.221995797000034, -120.29078024299992 42.21355127000004, -120.28354207599995 42.20631310300007, -120.28233571499993 42.191836770000066, -120.27147846499992 42.160471381000036, -120.2509703259999 42.14720140900005, -120.23890671499993 42.12910599200006, -120.23528763199994 42.10739149300008, -120.24011307599994 42.100153326000054, -120.23890671499993 42.092915159000086, -120.24493852099994 42.08929607600004, -120.24493852099994 42.080851548000055, -120.2425257989999 42.07602610400005, -120.24011307599994 42.05672432600005, -120.23528763199994 42.045867076000036, -120.22443038199992 42.036216187000036, -120.21960493799992 42.02897802100006, -120.21960493799992 42.02173985400009, -120.21839857599991 42.01450168800005, -120.2087476879999 42.01208896500009, -120.2027158819999 41.99640627100007, -120.19547771599991 41.98313629900008, -120.19097597899992 41.97831300900003, -120.1956136799999 41.97470590800003, -120.21110642999992 41.96517190800006, -120.21110642999992 41.95682965800006, -120.21825692999994 41.95682965800006, -120.23136618099994 41.95325440800008, -120.23017443099991 41.94372040800005, -120.22659918099993 41.93418640800007, -120.22898268099993 41.93061115800003, -120.23494143099992 41.93061115800003, -120.24566718099993 41.92941940800006, -120.25758468099991 41.92346065800007, -120.2611599309999 41.916310158000044, -120.25877643099994 41.90915965800008, -120.2528176809999 41.89128340800005, -120.2468589309999 41.878174158000036, -120.23732493099993 41.86387315700006, -120.22302393099994 41.84957215700007, -120.21229817999995 41.83169590700004, -120.20753117999993 41.812627907000035, -120.20753117999993 41.79594340700004, -120.21110642999992 41.780450657000074, -120.2170651799999 41.76734140700006, -120.22064042999995 41.756615657000054, -120.23136618099994 41.74708165700008, -120.23732493099993 41.73993115700006, -120.24805068099994 41.73516415700004, -120.2528176809999 41.72443840700004, -120.2635434309999 41.71728790700007, -120.27903618099992 41.71371265700009, -120.28141968099993 41.71132915700008, -120.2802279309999 41.706562156000075, -120.27546093099994 41.70417865600007, -120.26831043099992 41.702986906000035, -120.25877643099994 41.69941165600005, -120.25877643099994 41.69345290600006, -120.26473518099993 41.688685906000046, -120.27069393099993 41.68630240600004, -120.27426918099991 41.682727156000055, -120.2802279309999 41.68034365600005, -120.28499493099991 41.68034365600005, -120.28499493099991 41.67200140600005, -120.29214543099994 41.668426156000066, -120.29810418099993 41.668426156000066, -120.29810418099993 41.66365915600005, -120.30167943099991 41.65412515600008, -120.30167943099991 41.64935815600006, -120.29572068099992 41.64339940600007, -120.2885701809999 41.623139656000035, -120.28380318099994 41.61360565600006, -120.27546093099994 41.60764690600007, -120.27546093099994 41.59930465600007, -120.2718856809999 41.59334590600008, -120.27546093099994 41.58500365600008, -120.27546093099994 41.579044906000036, -120.26473518099993 41.57189440600007, -120.26473518099993 41.56236040600004, -120.26592693099991 41.55520990600007, -120.27069393099993 41.54805940600005, -120.27665268099992 41.55163465600003, -120.28380318099994 41.54210065500007, -120.2909536809999 41.52779965500008, -120.2885701809999 41.52184090500003, -120.2802279309999 41.50515640500004, -120.26592693099991 41.48847190500004, -120.2528176809999 41.478937905000066, -120.2444754309999 41.46582865500005, -120.24090018099992 41.45391115500007, -120.2361331809999 41.44437715500004, -120.22898268099993 41.427692655000044, -120.22659918099993 41.41100815500005, -120.22898268099993 41.40028240500004, -120.23255793099992 41.389556655000035, -120.22659918099993 41.37406390400008, -120.22064042999995 41.36095465400007, -120.2146816799999 41.35022890400006, -120.21110642999992 41.333544404000065, -120.20753117999993 41.319243404000076, -120.20157242999994 41.31209290400005, -120.1956136799999 41.29540840400006, -120.19203842999991 41.27634040400005, -120.1813126799999 41.253697154000065, -120.1705869299999 41.23701265400007, -120.1539024299999 41.23462915400006, -120.14436842999993 41.233437404000085, -120.13960142999991 41.229862154000045, -120.13602617999993 41.21913640300005, -120.13602617999993 41.21079415300005, -120.1372179299999 41.200068403000046, -120.13840967999994 41.18338390300005, -120.14198492999992 41.16669940300005, -120.14675192999994 41.16312415300007, -120.15747767999994 41.15478190300007, -120.16105292999993 41.14882315300008, -120.16939517999992 41.14643965300007, -120.17773742999992 41.14048090300008, -120.17416217999994 41.13333040300006, -120.17177867999993 41.128563403000044, -120.16581992999994 41.12498815300006, -120.1629868039999 41.12163991300008)), ((-121.98610691999994 38.085823116000086, -121.99221809999995 38.08387749600007, -121.99833683999992 38.086105356000076, -122.00446313999993 38.08888239600009, -122.01806645999994 38.098045296000066, -122.0144500799999 38.10193635600007, -122.00890355999991 38.10471339600008, -122.00195303999993 38.10305019600008, -121.99360661999992 38.09609985600008, -121.98750299999995 38.093879736000076, -121.98332213999993 38.090545596000084, -121.98610691999994 38.085823116000086)), ((-121.82611085999991 38.04916377600006, -121.8297272399999 38.04499821600007, -121.84973135999991 38.049720696000065, -121.85500337999991 38.05249017600005, -121.85193635999991 38.057212836000076, -121.83693695999995 38.065544136000085, -121.83277895999993 38.058044436000046, -121.82861321999991 38.05387869600008, -121.82611085999991 38.04916377600006)))"));
        Map<String, Object> props = findEcoregionProperties(GeoUtil.getPoint(37.880815, -122.142677), finder);
        assertThat(props.toString(), containsString("ECOREGION=Sacramento - San Joaquin, ECO_ID=125, ECO_ID_U=30125, MHT_NO=5, MHT_TXT=temperate coastal rivers, OLD_ID=6"));
    }

    @Test
    public void isFreshWaterRegionNetherlands() throws EcoregionFinderException {
        Map<String, Object> props = findEcoregionProperties(GeoUtil.getPoint(52.57635, 5.282593), new EcoregionFinderFactoryImpl().createEcoregionFinder(EcoregionType.FRESHWATER_ECOREGIONS_OF_THE_WORLD));
        assertThat(props.toString(), containsString("ECOREGION=Central & Western Europe, ECO_ID=404, ECO_ID_U=30404, MHT_NO=7, MHT_TXT=temperate floodplain rivers and wetlands, OLD_ID=306"));
    }

    @Test
    public void isFreshwaterRegionLagoGatun() throws EcoregionFinderException {
        EcoregionFinder finder = new EcoregionFinderFactoryImpl().createEcoregionFinder(EcoregionType.FRESHWATER_ECOREGIONS_OF_THE_WORLD);
        Collection<Ecoregion> ecoregion = finder.findEcoregion(9.2, -79.91667);
        assertThat(ecoregion.size(), is(1));
        assertThat(ecoregion.iterator().next().getName(), is("Chagres"));
        Map<String, Object> props = findEcoregionProperties(GeoUtil.getPoint(9.2, -79.91667), new EcoregionFinderFactoryImpl().createEcoregionFinder(EcoregionType.FRESHWATER_ECOREGIONS_OF_THE_WORLD));
        assertThat(props.toString(), containsString("ECOREGION=Chagres, ECO_ID=209, ECO_ID_U=30209, MHT_NO=8, MHT_TXT=tropical and subtropical coastal rivers, OLD_ID=121"));
    }

    @Test
    public void isMarineRegionInSacramento() throws EcoregionFinderException {
        Map<String, Object> props = findEcoregionProperties(pointInSacramento(), new EcoregionFinderFactoryImpl().createEcoregionFinder(EcoregionType.MARINE_ECOREGIONS_OF_THE_WORLD));
        assertThat(props.toString(), containsString("ALT_CODE=53.0, ECOREGION=Northern California, ECO_CODE=25058.0, ECO_CODE_X=58.0, Lat_Zone=Temperate, PROVINCE=Cold Temperate Northeast Pacific, PROV_CODE=10.0, REALM=Temperate Northern Pacific, RLM_CODE=3.0"));
    }

    @Test
    public void isMarineRegionInGulfOfMexico() throws EcoregionFinderException {
        // for some reason the coordinate system is lng, lat.
        Map<String, Object> props = findEcoregionProperties(pointInGulfOfMexico(), new EcoregionFinderFactoryImpl().createEcoregionFinder(EcoregionType.MARINE_ECOREGIONS_OF_THE_WORLD));
        assertThat((String) props.get("ECOREGION"), is("Northern Gulf of Mexico"));
    }


    @Test
    public void terrestrialMinnesota() throws EcoregionFinderException {
        EcoregionFinder finder = new EcoregionFinderFactoryImpl().createEcoregionFinder(EcoregionType.TERRESTRIAL_ECOREGIONS_OF_THE_WORLD);
        Point pointInMinnesota = GeoUtil.getPoint(44.4626988695, -93.1504054967);
        Map<String, Object> props = findEcoregionProperties(pointInMinnesota, finder);
        assertThat(props.toString(), containsString("CLS_CODE=1046, ECODE_NAME=NA0415. Prairie-Forest Border, ECO_CODE=NA0415, ECO_ID_U=17020, ECO_NAME=Prairie-Forest Border, ECO_NOTES=, ECO_NUM=15, ER_DATE_U=1/1/2001, ER_RATION=NA / D. Dorfman/ECO2001, ER_UPDATE=Original, RealmMHT=NA4, SOURCEDATA=Bailey, R, modified by TNC. 2004. Ecoregions of th, WWF_MHTNAM=Temperate Broadleaf and Mixed Forests, WWF_MHTNUM=4, WWF_REALM=NA, WWF_REALM2=Nearctic"));

        Ecoregion ecoregion = getFirst(finder.findEcoregion(44.4626988695, -93.1504054967));
        assertThat(ecoregion.getName(), is("Prairie-Forest Border"));
        assertThat(ecoregion.getId(), is("TEOW:17020"));
        assertThat(ecoregion.getPath(), is("Prairie-Forest Border | Temperate Broadleaf and Mixed Forests | Nearctic"));
        assertThat(ecoregion.getGeometry(), is(notNullValue()));
    }

    @Test
    public void terrestrialGulfOfMexico() throws EcoregionFinderException {
        assertNull(findEcoregionProperties(pointInGulfOfMexico(), new EcoregionFinderFactoryImpl().createEcoregionFinder(EcoregionType.TERRESTRIAL_ECOREGIONS_OF_THE_WORLD)));
    }

    @Test
    public void terrestrialSacramento() throws EcoregionFinderException {
        Map<String, Object> props = findEcoregionProperties(pointInSacramento(), new EcoregionFinderFactoryImpl().createEcoregionFinder(EcoregionType.TERRESTRIAL_ECOREGIONS_OF_THE_WORLD));
        assertThat(props.toString(), containsString("CLS_CODE=1013, ECODE_NAME=NA1209. Great Central Valley, ECO_CODE=NA1209, ECO_ID_U=17087, ECO_NAME=Great Central Valley, ECO_NOTES=Updated MHT from 8 to 12 ref Hoeksta et al May 05 MHT posse, ECO_NUM=9, ER_DATE_U=6/1/2003, ER_RATION=Yes/June2003/LSotomayor / M. Merrifield/June2003, ER_UPDATE=Updated, RealmMHT=NA12, SOURCEDATA=Bailey, R, modified by TNC. 2004. Ecoregions of th, WWF_MHTNAM=Mediterranean Forests, Woodlands and Scrub, WWF_MHTNUM=12, WWF_REALM=NA, WWF_REALM2=Nearctic"));
    }

    @Test
    public void terrestrialSanFranciscoBay() throws EcoregionFinderException {
        Map<String, Object> props = findEcoregionProperties(pointInSanFranciscoBay(), new EcoregionFinderFactoryImpl().createEcoregionFinder(EcoregionType.TERRESTRIAL_ECOREGIONS_OF_THE_WORLD));
        assertThat(props.toString(), containsString("CLS_CODE=1015, ECODE_NAME=NA1201. California Central Coast, ECO_CODE=NA1201, ECO_ID_U=17085, ECO_NAME=California Central Coast, ECO_NOTES=, ECO_NUM=1, ER_DATE_U=6/1/2003, ER_RATION=Yes/June2003/LSotomayor / M. Merrifield/June2003, ER_UPDATE=Updated, RealmMHT=NA12, SOURCEDATA=Bailey, R, modified by TNC. 2004. Ecoregions of th, WWF_MHTNAM=Mediterranean Forests, Woodlands and Scrub, WWF_MHTNUM=12, WWF_REALM=NA, WWF_REALM2=Nearctic"));
    }

    @Test
    public void terrestrialCoastalSanFranciscoBay() throws EcoregionFinderException {
        assertNull(findEcoregionProperties(pointInOffTheCoastOfSanFranciscoBay(), new EcoregionFinderFactoryImpl().createEcoregionFinder(EcoregionType.TERRESTRIAL_ECOREGIONS_OF_THE_WORLD)));
    }

    private Map<String, Object> findEcoregionProperties(Point point, EcoregionFinder finder) throws EcoregionFinderException {
        return ((EcoregionFinderImpl) finder).findEcoregion(point);
    }

    private Point pointInSanFranciscoBay() {
        return GeoUtil.getPoint(37.689254, -122.295799);
    }

    private Point pointInOffTheCoastOfSanFranciscoBay() {
        return GeoUtil.getPoint(37.51844, -123.839722);
    }

    private Point pointInSacramento() {
        return GeoUtil.getPoint(38.608286, -121.455689);
    }

    private Point pointInGulfOfMexico() {
        return GeoUtil.getPoint(27.547242, -96.815186);
    }

}
