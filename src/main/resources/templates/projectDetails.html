<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width,initial-scale=1" name="viewport"/>
    <title>Projekte | Adebar</title>
    <script type="text/javascript" src="../static/resources/js/jquery.min.js" th:src="@{/webjars/jquery/jquery.min.js}"></script>
    <script type="text/javascript" src="../static/resources/js/bootstrap.min.js" th:src="@{/webjars/bootstrap/js/bootstrap.min.js}"></script>
    <link rel="stylesheet" type="text/css" href="../static/resources/css/bootstrap.min.css" th:href="@{/webjars/bootstrap/css/bootstrap.min.css}"/>

    <link rel="stylesheet" type="text/css" href="../static/resources/css/style.css" th:href="@{/resources/css/style.css}"/>
    <link rel="stylesheet" type="text/css" href="../static/resources/css/animation.css" th:href="@{/resources/css/animation.css}"/>

    <script type="text/javascript" src="../static/resources/js/list.min.js" th:src="@{/resources/js/list.min.js}"></script>
    <script type="text/javascript" src="../static/resources/js/list.fuzzysearch.min.js" th:src="@{/resources/js/list.fuzzysearch.min.js}"></script>

    <link rel="stylesheet" type="text/css" href="../static/resources/css/bootstrap-datetimepicker.min.css" th:href="@{/resources/css/bootstrap-datetimepicker.min.css}" />
    <script type="text/javascript" src="../static/resources/js/moment-with-locales.min.js" th:src="@{/resources/js/moment-with-locales.min.js}"></script>
    <script type="text/javascript" src="../static/resources/js/bootstrap-datetimepicker.min.js" th:src="@{/resources/js/bootstrap-datetimepicker.min.js}"></script>

    <link rel="stylesheet" href="../static/resources/css/bootstrap-select.min.css" th:href="@{/resources/css/bootstrap-select.min.css}"/>
    <script src="../static/resources/js/bootstrap-select.min.js" th:src="@{/resources/js/bootstrap-select.min.js}"></script>

    <link rel="stylesheet" href="../static/resources/css/jquery.tablesorter.css" th:href="@{/resources/css/jquery.tablesorter.css}"/>
    <script src="../static/resources/js/jquery.tablesorter.min.js" th:src="@{/resources/js/jquery.tablesorter.min.js}"></script>

    <link rel="stylesheet" href="../static/resources/css/bootstrap-year-calendar.min.css" th:href="@{/resources/css/bootstrap-year-calendar.min.css}"/>
    <script src="../static/resources/js/bootstrap-year-calendar.min.js" th:src="@{/resources/js/bootstrap-year-calendar.min.js}"></script>
</head>
<body>
  
<!-- central navigation -->
<nav th:replace="navigation :: topNav(page='localGroups')"></nav>

<!-- modal dialogs -->
<section>
  <h2 class="hidden">Dialoge</h2>

  <!-- 'edit project' modal -->
  <section class="modal fade" id="edit-project-modal" tabindex="-1" role="dialog" aria-labelledby="edit-project-label">
      <div class="modal-dialog" role="document">
          <div class="modal-content">
              <header class="modal-header">
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                  </button>
                  <h3 class="modal-title" id="edit-project-label">Projekt anpassen</h3>
              </header>
              <section class="modal-body">
                  <form id="edit-project" class="form-horizontal" method="post" th:action="@{/projects/{id}/edit(id=${project.id})}" th:object="${projectForm}">
                      <input type="hidden" name="localGroupId" th:value="${project.localGroup.id}" />

                      <div class="form-group row">
                          <label class="control-label col-sm-4" for="edit-name">Name</label>
                          <div class="col-sm-8">
                              <input type="text" id="edit-name" class="form-control" placeholder="Name" required="required" th:field="*{name}"/>
                          </div>
                      </div>
                      <div class="form-group row">
                          <label class="control-label col-sm-4">Zeitraum <span class="glyphicon glyphicon-info-sign" data-toggle="tooltip" data-placement="right" data-title="optional"></span></label>
                          <div class="col-sm-8">
                              <div class="input-group" id="edit-project-period">
                                  <input type="text" class="form-control" placeholder="Start" th:field="*{start}" />
                                  <span class="input-group-addon">bis</span>
                                  <input type="text" class="form-control" placeholder="Ende" th:field="*{end}" />
                              </div>
                          </div>
                      </div>
                      <div class="form-group row">
                          <label for="edit-project-personInCharge" class="control-label col-sm-4">Hauptverantwortliche(r)</label>
                          <div class="col-sm-8">
                              <select id="edit-project-personInCharge" class="selectpicker" data-live-search="true" data-width="auto" th:remove="all-but-first" th:field="*{personInCharge}">
                                  <option value="1" th:each="contributor : ${contributors}" th:value="${contributor.id}" th:text="${contributor.name}">Maike Musterfrau</option>
                                  <option value="2">Heinz Meier</option>
                                  <option value="3">Frank von und zu Ährensteig</option>
                                  <option value="4">Gundula Franke</option>
                              </select>
                          </div>
                      </div>
                  </form>
              </section>
              <footer class="modal-footer">
                  <button type="button" class="btn btn-default" data-dismiss="modal">Abbrechen</button>
                  <button type="submit" class="btn btn-primary" form="edit-project">Aktualisieren</button>
              </footer>
          </div>
      </div>
  </section>

  <!-- 'add contributor' modal -->
  <section class="modal fade" id="add-contributor-modal" tabindex="-1" role="dialog" aria-labelledby="add-contributor-label">
      <div class="modal-dialog" role="document">
          <div class="modal-content">
              <header class="modal-header">
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                  </button>
                  <h3 class="modal-title" id="add-contributor-label">Aktiven hinzufügen</h3>
              </header>
              <section class="modal-body">
                  <div class="form-group clearfix">
                      <label class="col-sm-3 control-label">Aktive suchen</label>
                      <div class="col-sm-9">
                          <div class="clearfix" style="margin-bottom: 5px;">
                              <input type="text" id="add-contributor-search-firstname" class="form-control pull-left first-name" style="width: 48%;" placeholder="Vorname" />
                              <input type="text" id="add-contributor-search-lastname" class="form-control pull-right last-name" style="width: 48%;" placeholder="Nachname" />
                          </div>
                          <div class="clearfix">
                              <input type="text" id="add-contributor-search-city" class="form-control pull-left city" style="width: 68%;" placeholder="Ort"/>
                              <button type="button" id="add-contributor-search-btn" class="btn btn-primary pull-right search" style="padding-left: 20px; padding-right: 20px;">
                                  Suchen
                              </button>
                          </div>
                      </div>
                  </div>
                  <hr style="width: 100%; margin-top:5px;"/>
                  <form id="add-contributor" class="form-horizontal" method="post" th:action="@{/projects/{id}/contributors/add(id=${project.id})}">
                      <table class="table">
                          <thead>
                              <tr>
                                  <th>Name</th>
                                  <th>Geburtsdatum</th>
                                  <th>Adresse</th>
                                  <th>Auswählen</th>
                              </tr>
                          </thead>
                          <tbody id="add-contributor-tablebody" class="matches" th:remove="body">
                              <tr>
                                  <td>Max Mustermann</td>
                                  <td>31.02.1999</td>
                                  <td>Bei Mir 7 01234 Noch ein Dorf</td>
                                  <td class="text-center">
                                      <label><input type="radio" name="person-id" value="0" required="required" /></label>
                                  </td>
                              </tr>
                              <tr>
                                  <td>Claus Dieter</td>
                                  <td>17.07.1993</td>
                                  <td>Zu Hause 123 01478 Irgendein Dorf</td>
                                  <td class="text-center">
                                      <label><input type="radio" name="person-id" value="0" required="required" /></label>
                                  </td>
                              </tr>
                              <tr>
                                  <td>Friedlinde Müller</td>
                                  <td>11.11.1995</td>
                                  <td>Um die Ecke 3c 01597 Großstadt</td>
                                  <td class="text-center">
                                      <label><input type="radio" name="person-id" value="0" required="required" /></label>
                                  </td>
                              </tr>
                          </tbody>
                      </table>
                  </form>
                  <div class="text-center searching">
                      Suche läuft... <span class="glyphicon glyphicon-refresh glyphicon-load-animate"></span>
                  </div>
                  <div class="alert alert-info no-results">
                      Keine Übereinstimmung
                  </div>
              </section>
              <footer class="modal-footer">
                  <button type="button" class="btn btn-default" data-dismiss="modal">Abbrechen</button>
                  <button type="submit" class="btn btn-primary" form="add-contributor">Hinzufügen</button>
              </footer>
          </div>
      </div>
  </section>

  <!-- 'remove contributor' modal -->
  <section class="modal fade" id="remove-contributor-modal" tabindex="-1" role="dialog" aria-labelledby="remove-contributor-label">
      <div class="modal-dialog" role="document">
          <div class="modal-content">
              <header class="modal-header">
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                  </button>
                  <h3 class="modal-title" id="remove-contributor-label">Aktiven entfernen</h3>
              </header>
              <section class="modal-body">
                  <form id="remove-contributor" class="form-horizontal" method="post" th:action="@{/projects/{id}/contributors/remove(id=${project.id})}">
                      <input type="hidden" name="person-id" value="-1" />
                      <input type="hidden" name="_csrf" value="-1" />
                      <label for="remove-contributor-name" class="sr-only">Name</label>
                      <input type="text" id="remove-contributor-name" class="form-control" value="Max Mustermann" readonly="readonly" disabled="disabled" />
                  </form>
              </section>
              <footer class="modal-footer">
                  <button type="button" class="btn btn-default" data-dismiss="modal">Abbrechen</button>
                  <div class="btn-group">
                     <button type="button" class="btn btn-danger dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <span class="glyphicon glyphicon-trash"></span> Löschen <span class="caret"></span>
                     </button>
                     <ul class="dropdown-menu confirm-delete">
                        <li><button type="submit" class="btn btn-link" form="remove-contributor">Löschen</button></li>
                     </ul>
                  </div>
              </footer>
          </div>
      </div>
  </section>

  <!-- 'add event' modal -->
  <section class="modal fade" id="add-event-modal" tabindex="-1" role="dialog" aria-labelledby="add-event-label">
      <div class="modal-dialog" role="document">
          <div class="modal-content">
              <header class="modal-header">
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                  </button>
                  <h3 class="modal-title" id="add-event-label">Veranstaltung erstellen</h3>
              </header>
              <section class="modal-body">
                  <form id="add-event" class="form-horizontal" method="post" th:object="${addEventForm}" th:action="@{/events/add}">
                      <input type="hidden" name="belonging" th:value="PROJECT" />
                      <input type="hidden" value="-1" name="projectId" th:value="${project.id}" />

                      <div class="form-group">
                          <label for="name" class="col-sm-3 control-label">Name</label>
                          <div class="col-sm-9">
                              <input type="text" id="name" class="form-control" name="name" placeholder="Name" autofocus="" required="required" th:field="*{name}" />
                          </div>
                      </div>
                      <div class="form-group">
                          <label for="start-time" class="col-sm-3 control-label">Von <span class="glyphicon glyphicon-info-sign" data-toggle="tooltip" data-placement="right" data-title="Format: DD.MM.YYYY. Wenn die Uhrzeit unwichtig ist, einfach auf 00:00 setzen"></span></label>
                          <div class="col-sm-9">
                              <div class="input-group date" id="event-startTime-picker">
                                  <input type="text" class="form-control" name="start-time" id="add-event-startTime" placeholder="Startzeit" required="required" th:field="*{startTime}"/>
                                  <span class="input-group-addon">
                                      <span class="glyphicon glyphicon-calendar"></span>
                                  </span>
                              </div>
                          </div>
                      </div>
                      <div class="form-group">
                          <label for="end-time" class="col-sm-3 control-label">Bis <span class="glyphicon glyphicon-info-sign" data-toggle="tooltip" data-placement="right" data-title="Format: DD.MM.YYYY. Wenn die Uhrzeit unwichtig ist, einfach auf 00:00 setzen"></span></label>
                          <div class="col-sm-9">
                              <div class="input-group date" id="event-endTime-picker">
                                  <input type="text" class="form-control" name="end-time" id="add-event-endTime" placeholder="Endzeit" required="required" th:field="*{endTime}"/>
                                  <span class="input-group-addon">
                                      <span class="glyphicon glyphicon-calendar"></span>
                                  </span>
                              </div>
                          </div>
                      </div>
                      <div class="form-group">
                          <label for="participants-limit" class="col-sm-3 control-label">Max. Teilnehmer</label>
                          <div class="col-sm-9">
                              <div class="input-group">
                                  <input type="number" class="form-control" name="participants-limit" id="participants-limit" placeholder="Teilnehmerlimit" th:field="*{participantsLimit}" />
                                  <span class="input-group-addon">
                                      Teilnehmer
                                  </span>
                              </div>
                          </div>
                      </div>
                      <div class="form-group">
                          <label for="participants-age" class="col-sm-3 control-label">Teilnehmeralter</label>
                          <div class="col-sm-9">
                              <div class="input-group">
                                  <input type="number" class="form-control" name="participants-age" id="participants-age" placeholder="min. Alter" th:field="*{participantsAge}"/>
                                  <span class="input-group-addon">
                                      Jahre
                                  </span>
                              </div>
                          </div>
                      </div>
                      <div class="form-group">
                          <label for="add-event-fees" class="col-sm-3 control-label">Preis</label>
                          <div class="col-sm-9" id="add-event-fees">
                              <div class="input-group margin-btm">
                                  <input type="number" step="0.1" class="form-control" name="internalFee" id="internalFee" placeholder="NAJU-Mitglieder" th:field="*{internalParticipationFee}" />
                                  <span class="input-group-addon"><span class="glyphicon glyphicon-eur"></span></span>
                              </div>
                              <div class="input-group">
                                  <input type="number" step="0.1" class="form-control" name="externalFee" id="externalFee" placeholder="nicht-Mitglieder" th:field="*{externalParticipationFee}" />
                                  <span class="input-group-addon"><span class="glyphicon glyphicon-eur"></span></span>
                              </div>
                          </div>
                      </div>
                      <div class="form-group">
                          <label for="add-event-address" class="col-sm-3 control-label">Ort</label>
                          <div class="col-sm-9 address" id="add-event-address">
                              <input type="text" class="form-control street" name="street" placeholder="Straße, HNr." th:field="*{street}"/>
                              <input type="text" class="form-control zip" name="zip" placeholder="Plz" style="width: 30%; float: left;" th:field="*{zip}"/>
                              <input type="text" class="form-control city" name="city" placeholder="Stadt" style="width: 67%; float: right;" th:field="*{city}"/>
                          </div>
                      </div>
                  </form>
              </section>
              <footer class="modal-footer">
                  <button type="button" class="btn btn-default" data-dismiss="modal">Abbrechen</button>
                  <button type="submit" class="btn btn-primary" form="add-event">Erstellen</button>
              </footer>
          </div>
      </div>
  </section>

</section>

<!-- page specific content-->
<main id="main">

    <!-- page specific menu items -->
    <header id="action-bar" class="form-inline clearfix">
        <h2 class="hidden">Menü</h2>

        <div class="pull-left" style="margin-top: 5px;">
            <a href="localGroupDetails.html" th:href="@{/localGroups/{id}(id=${project.localGroup.id})}">
                <span class="glyphicon glyphicon-chevron-left"></span> Zurück zur Ortsgruppe
            </a>
        </div>

        <!-- the actions at last -->
        <div id="actions" class="pull-right">

            <div class="btn-group">
                <button type="button" class="btn btn-default" data-toggle="modal" data-target="#edit-project-modal">
                    <span class="glyphicon glyphicon-pencil"></span> Anpassen
                </button>
            </div>
        </div>
    </header>

    <!-- the 'real' content finally -->
    <section id="content" class="tab-content" style="margin-top: 2em;">

        <h1>Projekt Details</h1>

        <!-- status messages -->
        <div id="status">
            <h2 class="hidden">Status</h2>

            <div class="alert alert-success alert-dismissible" role="alert" th:if="${projectAdded}">
               <button type="button" class="close" data-dismiss="alert" aria-label="Schließen">
                  <span aria-hidden="true">&times;</span>
               </button>
               <p>
                  Projekt wurde erstellt
               </p>
            </div>

            <div class="alert alert-success alert-dismissible" role="alert" th:if="${contributorAdded}">
               <button type="button" class="close" data-dismiss="alert" aria-label="Schließen">
                  <span aria-hidden="true">&times;</span>
               </button>
               <p>
                  Aktive(r) wurde hinzugefügt
               </p>
            </div>

            <div class="alert alert-info alert-dismissible" role="alert" th:if="${projectUpdated}">
               <button type="button" class="close" data-dismiss="alert" aria-label="Schließen">
                  <span aria-hidden="true">&times;</span>
               </button>
               <p>
                  Projekt wurde aktualisiert
               </p>
            </div>

            <div class="alert alert-info alert-dismissible" role="alert" th:if="${contributorRemoving}">
               <button type="button" class="close" data-dismiss="alert" aria-label="Schließen">
                  <span aria-hidden="true">&times;</span>
               </button>
               <p>
                  Aktive(r) wurde entfernt
               </p>
            </div>

            <div class="alert alert-warning alert-dismissible" role="alert" th:if="${existingContributor}">
               <button type="button" class="close" data-dismiss="alert" aria-label="Schließen">
                  <span aria-hidden="true">&times;</span>
               </button>
               <p>
                  Person trägt bereits zum Projekt bei
               </p>
            </div>

        </div>

        <!-- general overview and members -->
        <div class="row">

            <!-- general overview -->
            <div class="col-md-4">
                <div class="panel panel-primary">
                    <header class="panel-heading">
                        <h2 class="panel-title">Überblick</h2>
                    </header>
                    <table class="table">
                        <tbody>
                            <tr>
                                <th><span class="glyphicon glyphicon-tag"></span> Name</th>
                                <td th:text="${project.name}">Puppenstuben gesucht!</td>
                            </tr>
                            <tr>
                                <th><span class="glyphicon glyphicon-calendar"></span> Zeitraum</th>
                                <td th:text="|${{project.startTime}} - ${{project.endTime}}|">2017 - 2019</td>
                            </tr>
                            <tr>
                                <th><span class="glyphicon glyphicon-king"></span> Verantwortlicher</th>
                                <td>
                                    <a href="mailto:" th:if="${project.getPersonInCharge() != null}" th:href="|mailto: ${project.personInCharge.email}|" th:text="${project.personInCharge.name}">Hans Meier</a>
                                    <span th:unless="${project.getPersonInCharge() != null}">---</span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- contributor overview -->
            <div class="col-md-8">
                <div class="panel panel-default">
                    <header class="panel-heading panel-menu">
                        <h2 class="panel-title">Aktive</h2>
                        <div class="btn-group panel-menu-container">
                            <button type="button" class="btn btn-default" data-toggle="modal" data-target="#add-contributor-modal">
                                <span class="glyphicon glyphicon-plus"></span> Hinzufügen
                            </button>
                            <a href="mailto:" class="btn btn-default" th:href="|mailto: ${contributorEmails}|">
                                <span class="glyphicon glyphicon-envelope"></span> E-Mail
                            </a>
                        </div>
                    </header>
                    <ul id="contributors" class="list-group list-group-hover" th:remove="all-but-first">
                        <li class="list-group-item list-group-item-interactive" data-toggle="modal" data-target="#remove-contributor-modal" data-id="1" data-name="Maxi Musterfrau" th:each="contributor : ${project.contributors}" th:attr="'data-id'=${contributor.id}, 'data-name'=${contributor.name}">
                            <a href="personDetails.html" th:href="@{/persons/{id}(id=${contributor.id})}">
                                <span class="glyphicon glyphicon-link"></span>
                            </a> <span th:text="${contributor.name}">Maxi Musterfrau</span> (<a href="mailto:maxi.musterfrau@naju-sachsen.de" th:href="|mailto: ${contributor.email}|" th:text="${contributor.email}">maxi.musterfrau@naju-sachsen.de</a>)
                        </li>
                        <li class="list-group-item list-group-item-interactive" data-toggle="modal" data-target="#remove-contributor-modal" data-id="2" data-name="Heinz Heimlich">
                            <a href="personDetails.html">
                                <span class="glyphicon glyphicon-link"></span>
                            </a> <span>Heinz Heimlich</span> (<a href="mailto:heinz.heimlich@naju-sachsen.de">heinz.heimlich@naju-sachsen.de</a>)
                        </li>
                        <li class="list-group-item list-group-item-interactive" data-toggle="modal" data-target="#remove-contributor-modal" data-id="3" data-name="Dieter Lustig">
                            <a href="personDetails.html">
                                <span class="glyphicon glyphicon-link"></span>
                            </a> <span>Dieter Lustig</span> (<a href="mailto:dieter.lustig@naju-sachsen.de">dieter.lustig@naju-sachsen.de</a>)
                        </li>
                        <li class="list-group-item list-group-item-interactive" data-toggle="modal" data-target="#remove-contributor-modal" data-id="4" data-name="Klaus Klücklich">
                            <a href="personDetails.html">
                                <span class="glyphicon glyphicon-link"></span>
                            </a> <span>Klaus Klücklich</span> (<a href="mailto:klaus.kluecklich@naju-sachsen.de">klaus.kluecklich@naju-sachsen.de</a>)
                        </li>
                    </ul>
                </div>
            </div>

        </div>

        <!-- event overview -->
        <div class="row" id="events">
            <div class="col-md-8 pull-right">
                <div class="panel panel-default">
                    <header class="panel-heading panel-menu">
                        <h2 class="panel-title">Veranstaltungen</h2>
                        <div class="input-group panel-menu-container">
                            <button type="button" class="btn btn-default" data-toggle="modal" data-target="#add-event-modal">
                                <span class="glyphicon glyphicon-plus"></span> Hinzufügen
                            </button>
                        </div>
                    </header>
                    <table class="table table-striped table-hover">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Datum</th>
                                <th>Ort</th>
                                <th>Anmeldungen</th>
                                <th><span class="sr-only">Link</span><span class="glyphicon glyphicon-link" aria-hidden="true"></span></th>
                            </tr>
                        </thead>
                        <tbody th:remove="all-but-first">
                            <tr th:each="event : ${project.events}">
                                <td th:text="${event.name}">Mahdeinsatz auf dem Dachsenberg</td>
                                <td th:text="|${{event.startTime}} - ${{event.endTime}}|">24.04.17</td>
                                <td th:text="${event.place} ? ${event.place.city} : '---'">Dachsenberg</td>
                                <td class="text-center" th:text="${event.participantsCount}">7</td>
                                <td><a href="eventDetails.html" th:href="@{/events/{id}(id=${event.id})}">Details</a></td>
                            </tr>
                            <tr>
                                <td>Weiterbildung Schmetterlinge</td>
                                <td>24.04.17 - 26.04.17</td>
                                <td>Dachsenberg</td>
                                <td class="text-center">3</td>
                                <td><a href="eventDetails.html">Details</a></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

    </section>

    <script type="text/javascript">

    </script>
    <input type="hidden" id="local-group-id" value="-1" th:value="${project.localGroup.id}" />

    <form id="logout-user" method="POST" th:action="@{/logout}">
      <input type="hidden" name="csrf" th:value="csrf" />
    </form>

</main>

<input type="hidden" id="csrf" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
<script src="../static/resources/js/displayMatchingPersons.js" th:src="@{/resources/js/displayMatchingPersons.js}"></script>
<script src="../static/resources/js/personSearch.js" th:src="@{/resources/js/personSearch.js}"></script>
<script src="../static/resources/js/init.js" th:src="@{/resources/js/init.js}"></script>
<script src="../static/resources/js/projectDetails.js" th:src="@{/resources/js/projectDetails.js}"></script>

</body>
</html>
