<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta charset="utf-8"/>
  <meta content="width=device-width,initial-scale=1" name="viewport"/>
  <meta th:name="_csrf" th:value="${_csrf.token}"/>
  <title>Jane Doe | Adebar</title>
  <link rel="stylesheet" type="text/css" href="../../static/resources/css/bootstrap.min.css"
        th:href="@{/webjars/bootstrap/css/bootstrap.min.css}"/>

  <link rel="stylesheet" type="text/css" href="../../static/resources/css/style.css"
        th:href="@{/resources/css/style.css}"/>
  <link rel="stylesheet" type="text/css" href="../../static/resources/css/personDetails.css"
        th:href="@{/resources/css/personDetails.css}"/>
</head>
<body>

<!-- central navigation -->
<nav th:replace="navigation :: topNav(page='persons')"></nav>

<!-- page specific content-->
<main id="main">

  <a href="persons.html">
    <span class="glyphicon glyphicon-chevron-left"></span>
    Zurück zur Übersicht
  </a>

  <h1>Profil von Jane Doe</h1>

  <ul class="nav nav-tabs" role="tablist">
    <li role="presentation" class="active">
      <a href="#overview" class="tab-controller" aria-controls="general" role="tab"
         data-toggle="tab">Allgemeine Infos</a>
    </li>
    <li role="presentation">
      <a href="#activist-referent" class="tab-controller" aria-controls="activist-referent"
         role="tab" data-toggle="tab">Aktiven + Referenteninfos</a>
    </li>
    <li role="presentation">
      <a href="#events" class="tab-controller" aria-controls="events" role="tab" data-toggle="tab">Teilgenommene
        Veranstaltungen</a>
    </li>
    <li role="presentation">
      <a href="#newsletters" class="tab-controller" aria-controls="newsletters" role="tab"
         data-toggle="tab">Newsletter</a>
    </li>
  </ul>

  <article class="tab-content">

    <!-- general and relationship -->
    <div id="overview" class="tab-pane active container-fluid" role="tabpanel">

      <!-- general -->
      <section id="referent" class="display-category" th:fragment="profile">

        <div class="row category-header">
          <h2 class="col-md-10">Referent*innen-Profil</h2>

          <div class="col-md-2 category-menu"
               th:if="${referent} and not ${#iterables.isEmpty(referent.qualifications)}">
            <button type="button" class="btn btn-default btn-sm pull-right" data-toggle="modal"
                    data-target="#add-qualification-dialog">
              <span class="glyphicon glyphicon-plus"></span> Hinzufügen
            </button>
          </div>

        </div>

        <div class="row" th:if="${referent}">
          <div class="col-md-10 col-md-offset-1"
               th:unless="${#iterables.isEmpty(referent.qualifications)}">
            <div class="table-responsive">
              <table class="table table-striped table-hover">
                <thead>
                <tr class="row">
                  <th class="col-md-3">Qualifikation</th>
                  <th class="col-md-7">Beschreibung</th>
                  <th class="col-md-2"></th>
                </tr>
                </thead>
                <tbody th:remove="all-but-first">
                <tr class="row" th:each="qualification : ${referent.qualifications}">
                  <td class="col-md-3" th:text="${qualification.name}">Ornithologie</td>
                  <td class="col-md-7" th:text="${qualification.description}">Theoretisches und
                    praktische Kenntnisse auf dem Gebiet der Vogelkunde
                  </td>
                  <td class="col-md-2">
                    <form method="post"
                          th:action="@{/persons/{id}/referent-profile/qualifications/remove(id=${personId})}">
                      <input type="hidden" name="qualification-id"
                             th:value="${qualification.name}"/>
                      <button type="submit" class="btn btn-link btn-inline">
                        Entfernen
                      </button>
                    </form>
                  </td>
                </tr>
                </tbody>
              </table>
            </div>
          </div>
          <div class="col-md-12"
               th:if="${#iterables.isEmpty(referent.qualifications)}">
            <div>
              Für den/die Referent*in sind zur Zeit keine Qualifikationen hinterlegt.
            </div>
            <button type="button" class="btn btn-link no-padding" data-toggle="modal"
                    data-target="#add-qualification-dialog">
              Jetzt hinzufügen
            </button>
          </div>
        </div>

        <div class="row" th:unless="${referent}">
          Die Person ist uns bisher nicht als Referent*in bekannt.
          <form method="post"
                th:action="@{/persons/{id}/referent-profile/create(id=${personId})}">
            <button type="submit" class="btn btn-link btn-inline">
              <span class="glyphicon glyphicon-arrow-right"></span>
              Jetzt als Referent*in registrieren.
            </button>
          </form>
        </div>

        <div class="modal fade modal-tabbed" id="add-qualification-dialog" tabindex="-1"
             role="dialog" th:if="${referent}">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h3>Qualifikation hinzufügen</h3>
              </div>
              <div class="modal-body">
                <div class="container-fluid">

                  <ul class="nav nav-tabs" role="tablist">
                    <li role="presentation" class="active">
                      <a href="#new-qualification" id="new" role="tab" data-toggle="tab">Neu
                        erstellen</a>
                    </li>
                    <li role="presentation">
                      <a href="#existing-qualification" id="existing" role="tab"
                         data-toggle="tab">Auswählen</a>
                    </li>
                  </ul>

                  <form class="tab-content margin-top-lg" method="post"
                        id="add-qualification"
                        th:action="@{/persons/{id}/referent-profile/qualifications/add(id=${personId})}"
                        th:object="${addQualificationForm}">
                    <div role="tabpanel" class="tab-pane active"
                         id="new-qualification">
                      <div class="form-group"
                           th:classappend="${#fields.hasErrors('newQualificationName')} ? 'has-error'">
                        <label for="new-qualification-name" class="control-label">
                          Name
                        </label>
                        <input type="text" class="form-control" id="new-qualification-name"
                               placeholder="Kurz und knackig bitte"
                               th:field="*{newQualificationName}"/>
                        <p class="help-block" th:if="${#fields.hasErrors('newQualificationName')}"
                           th:errors="*{newQualificationName}">Erforderlich</p>
                      </div>
                      <div class="form-group"
                           th:classappend="${#fields.hasErrors('newQualificationDescription')} ? 'has-error'">
                        <label for="new-qualification-description" class="control-label">
                          Beschreibung
                        </label>
                        <textarea class="form-control" id="new-qualification-description"
                                  placeholder="Wofür ist die Qualifikation"
                                  th:field="*{newQualificationDescription}"></textarea>
                        <p class="help-block"
                           th:if="${#fields.hasErrors('newQualificationDescription')}"
                           th:errors="*{newQualificationDescription}">Erforderlich</p>
                      </div>
                    </div>
                    <div role="tabpanel" class="tab-pane" id="existing-qualification">
                      <div class="form-group"
                           th:classappend="${#fields.hasErrors('existingQualificationKey')} ? 'has-error'">
                        <label for="existing-qualification-select" class="control-label">
                          Bitte auswählen:
                        </label>
                        <select class="form-control" id="existing-qualification-select"
                                multiple="multiple"
                                size="15" th:remove="all-but-first"
                                th:field="*{existingQualificationKey}">
                          <option th:each="qualification : ${qualificationsToAdd}"
                                  th:inline="text" th:value="${qualification.name}">
                            [[${qualification.name}]] [[${not qualification.description.empty}
                            ? '(' + ${qualification.description} + ')' : '']]
                          </option>
                          <option>
                            Erste-Hilfe Kurs (Macht Auas wieder weg)
                          </option>
                          <option>
                            Umweltpädagogik (Weiß wie man so Umwelt-Zeugs Leuten erzählt)
                          </option>
                          <option>
                            Ornithologie (Piep piep)
                          </option>
                        </select>
                        <p class="help-block"
                           th:if="${#fields.hasErrors('existingQualificationKey')}"
                           th:errors="*{existingQualificationKey}">Erforderlich</p>
                      </div>
                    </div>
                  </form>
                </div>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">
                  Abbrechen
                </button>
                <button type="submit" form="add-qualification" class="btn btn-primary">
                  Speichern
                </button>
              </div>
            </div>
          </div>
        </div>

      </section>

    </div>

  </article>

</main>

<form id="logout-user" method="POST" th:action="@{/logout}">
  <input type="hidden" name="csrf" th:value="csrf"/>
</form>

<script type="text/javascript" src="../../static/resources/js/jquery.min.js"
        th:src="@{/webjars/jquery/jquery.min.js}"></script>
<script type="text/javascript" src="../../static/resources/js/bootstrap.min.js"
        th:src="@{/webjars/bootstrap/js/bootstrap.min.js}"></script>
<script type="text/javascript" src="../../static/resources/js/bootstrap-select.min.js"
        th:src="@{/resources/js/bootstrap-select.min.js}"></script>
<script src="../../static/resources/js/init.js" th:src="@{/resources/js/init.js}"></script>
<script src="../../static/resources/js/formControls.js"
        th:src="@{/resources/js/formControls.js}"></script>
<script src="../../static/resources/js/personDetails.js"
        th:src="@{/resources/js/personDetails.js}"></script>
</body>
</html>
